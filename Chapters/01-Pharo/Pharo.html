<!DOCTYPE html>
<html>
  <head>
    <title>Pharo Book</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="images/favicon.png" type="image/x-icon" />
<link href="/DynamicWebDevelopmentWithSeaside/_support/html/css/font-awesome.min.css" rel="stylesheet">
<link href="/DynamicWebDevelopmentWithSeaside/_support/html/css/nucleus.css" rel="stylesheet">
<link href="/DynamicWebDevelopmentWithSeaside/_support/html/css/flex.css" rel="stylesheet">
<link rel="stylesheet" href="/DynamicWebDevelopmentWithSeaside/_support/html/css/bootstrap.min.css">
<script src="/DynamicWebDevelopmentWithSeaside/_support/html/js/jquery-2.x.min.js"></script>
<script src="/DynamicWebDevelopmentWithSeaside/_support/html/highlightjs/highlight.pack.js"></script>
<script src="/DynamicWebDevelopmentWithSeaside/_support/html/js/highlight-commands.js"></script>
<meta name="description" content="">
<meta name="author" content="Stéphane Ducasse \ (based on S. Ducasse, D.C. Shaffer, L. Renggli, and R. Zaccone)">
  </head>
  <body>
    <header>
  <div class="logo">
    <a class="baselink" href="/DynamicWebDevelopmentWithSeaside/">Pharo Book</a>
  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
  
</header>
<article>
  <aside>
    <ul class="menu">
   		<li data-nav-id="123" class="dd-item">
    		<a href="/DynamicWebDevelopmentWithSeaside">
		       <i class="fa fa-fw fa-home"></i>
	    	</a>
        </li>

		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/DynamicWebDevelopmentWithSeaside/index.html#getting started">
					Getting Started
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item  haschildren ">
					<div>
						<a href="/DynamicWebDevelopmentWithSeaside/Chapters/02-Gemstone/Gemstone.html#getting started in gemstone/s">
							Getting Started in Gemstone/S
						</a>
						<i class="fa fa-angle-right fa-lg category-icon"></i>
					</div>

					<ul class="dd-item">
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/Chapters/02-Gemstone/Gemstone.html#using the glass virtual appliance">Using the GLASS Virtual Appliance</a>
						</li>
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/Chapters/02-Gemstone/Gemstone.html#a first seaside component">A first Seaside Component</a>
						</li>
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/Chapters/02-Gemstone/Gemstone.html#defining a component">Defining a Component</a>
						</li>
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/Chapters/02-Gemstone/Gemstone.html#defining some methods">Defining Some Methods</a>
						</li>
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/Chapters/02-Gemstone/Gemstone.html#rendering a counter">Rendering a Counter</a>
						</li>
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/Chapters/02-Gemstone/Gemstone.html#registering the application">Registering the application</a>
						</li>
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/Chapters/02-Gemstone/Gemstone.html#adding behavior">Adding Behavior</a>
						</li>
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/Chapters/02-Gemstone/Gemstone.html#keeping up with the latest features">Keeping Up with the Latest Features</a>
						</li>
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/DynamicWebDevelopmentWithSeaside/index.html#gemstone version">
							Gemstone version
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item ">
			<div>
			  <a href="/DynamicWebDevelopmentWithSeaside/index.html#fundamentals">
					Fundamentals
			  </a>
			  
			</div>
			  <ul class="dd-item">
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item ">
			<div>
			  <a href="/DynamicWebDevelopmentWithSeaside/index.html#using components">
					Using Components
			  </a>
			  
			</div>
			  <ul class="dd-item">
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/DynamicWebDevelopmentWithSeaside/index.html#seaside in action">
					Seaside in Action
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item  haschildren ">
					<div>
						<a href="/DynamicWebDevelopmentWithSeaside/index.html#wish list of new chapter">
							Wish list of new chapter
						</a>
						<i class="fa fa-angle-right fa-lg category-icon"></i>
					</div>

					<ul class="dd-item">
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/index.html#willow?">Willow?</a>
						</li>
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/index.html#bootstrap">Bootstrap</a>
						</li>
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/index.html#mdl">MDL</a>
						</li>
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/index.html#mustaside">Mustaside</a>
						</li>
							
						<li class="dd-item">
							<a href="/DynamicWebDevelopmentWithSeaside/index.html#websockets">WebSockets</a>
						</li>
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
    </ul>
  </aside>

  <section class="page">
    
	<h1>Dynamic Web Development with Seaside</h1>
		
	<h2>Getting Started in Pharo</h2>
<a id="cha:gettingstarted-pharo"></a>

<p>
In this chapter we will explain how to develop a first simple Seaside application: a simple counter. 
You will follow the entire procedure of creating a Seaside application. This process will highlight some of the features of Seaside such as callbacks and a DSL to emit HTML.
</p>
<p>
We will neither explain the Pharo syntax nor the IDE. We will not explain how to define packages, classes or methods but obviously we will present their definition. If you are new to Pharo, we suggest you to read chapters 3, 4 and 5 of <em>Pharo by
Example</em> which is a free and online book available from <a href="htp://books.pharo.org">htp://books.pharo.org</a>  and the Pharo mooc available at <a href="http://mooc.pharo.org">http://mooc.pharo.org</a>.
</p>
<h3>Getting Seaside</h3>
<a id="pharoOneClickImage"></a>
<p>
In this book, we use Seaside 3.0.4, included in the <em>One Click Image</em> which
you can find on the Seaside website at <a href="http://www.seaside.st/download">http://www.seaside.st/download</a>. The
<em>One Click Image</em> is a bundle of everything you need to run Seaside. 
</p>
<p>
<a id="fig:seasideDesk"></a>
<figure>
	<img src="figures/seasideApplicationDesk.png" width="100%" id="fig:seasideDesk" alt="The Seaside development environment."/>
	<figcaption>The Seaside development environment.</figcaption>
</figure>
</p>
<p>
You should see the Seaside development environment open in
a single window on your desktop similar to the one presented in Figure <a href="#fig:seasileDesk"></a>.
</p>
<p class="todo">revise</p>

<h3>Starting the Server </h3>
<a id="pharoComancheServer"></a>

<p class="todo">Revise</p><p>
The <em>One Click Image</em> image includes a web server called &quot;Comanche&quot; listening
on TCP port 8080. You should check that this server is properly running by
pointing your web browser to <a href="http://localhost:8080/">http://localhost:8080/</a>. You should see something
like Figure <a href="#fig:seasideServer"></a>. If you don’t see this page, it is possible
that port 8080 is already in use by another application on your computer.
</p>
<p>
<a id="fig:seasideServer"></a>
<figure>
	<img src="figures/seasideServer.png" width="100%" id="fig:seasideServer" alt="The Seaside server running."/>
	<figcaption>The Seaside server running.</figcaption>
</figure>
</p>
<p>
<strong>Changing the Seaside port number.</strong>
If you did not see Figure <a href="#fig:seasideServer"></a>, you will need to try modifying
the workspace to restart the Comanche web server on a different port number
(like 8081). The script <a href="#scr:startServer"></a> asks the server to stop serving and start
serving on port 8081.
</p>
<figure><pre><code class="smalltalk">
WAKom stop.
WAKom startOn: 8081.</code></pre><figcaption><a id="scr:startServer"></a>Stop the server and start a new one.</figcaption></figure>

<p>
To execute this, you would open a new workspace using <em>World</em> | <em>Workspace</em>,
enter the text, select it, right-click for the context menu, and select
<em>Do it</em>.
</p>
<p>
Once you have done this, you can try to view it in your browser making sure you
use the new port number in your URL. Once you have found an available port, make
sure you note what port the server is running on. Throughout this book we assume
port 8080 so if you’re using a different port you will have to modify any URLs
we give you accordingly.
</p>
<h3>A First Seaside Component</h3>
<a id="pharoFirstSeasideComponent"></a>
<p>
Now we are ready to write our first Seaside component. We are going to code a
simple counter. To do this we will define a component, add some state to that
component, and then create a couple of methods that define how the component is
rendered in the web browser. We will then register it as a Seaside application.
</p>
<h4>Defining a Package</h4>
<a id="pharoDefineCategory"></a>
<p>
To start with, we define a new package that will contain the class that defines
our component. We will save our class in this package. 
</p>
<h4>Defining a Component</h4>
<a id="pharoDefineComponent"></a>
<p>
Now we will define a new component named <code>WebCounter</code>. In Seaside, a
<em>component</em> refers to any class which inherits from the class <code>WAComponent</code>
(either directly or indirectly).
</p>
<p class="note">It is only a coincidence that this class has the same name as its package. Normally packages will contain several classes, and the package names and class names are unrelated.</p>
<p>
To start creating your class, click on the <code>WebCounter</code> package you just
created. The &quot;class creation template&quot; will appear in the source pane of the browser. Edit this template so that it looks as
in the script <a href="#scr:pharoClassTemplate"></a>
</p>
<figure><pre><code class="smalltalk">WAComponent subclass: #WebCounter
    instanceVariableNames: 'count'
    classVariableNames: ''
    package: 'WebCounter'</code></pre><figcaption><a id="scr:pharoClassTemplate"></a>Pharo class template for the <code>Web Counter</code></figcaption></figure>

<p>
Notice that lines 3 and 4 contain two consecutive single quote characters, not a
double quote character. We are specifying that the <code>WebCounter</code> class is a new
subclass of <code>WAComponent</code>. We also specify that this class has one instance
variable named count. The other arguments are empty, so we just pass an empty
string, indicated by two consecutive quote marks. The &quot;package&quot; value should
already match the package name. Note that an orange triangle in the top-right
indicates that the code is not compiled yet.
</p>
<p>
Once you are done entering the class definition, right-click anywhere in that
pane to bring up the context menu, and select the menu item <em>Accept (s)</em> as
shown in Figure <a href=""></a>. Accept in Pharo jargon means
compile.
</p>
<p>
<a id="fig:createClass"></a>
<figure>
	<img src="figures/createClass.png" width="100%" id="fig:createClass" alt="Creating the class WebCounter."/>
	<figcaption>Creating the class <code>WebCounter</code>.</figcaption>
</figure>
</p>
<p>
Once you have accepted, your browser should look similar to the one shown in
Figure <a href="#fig:createdClass"></a>. The browser now shows the class that you have
created in the class pane. Now we are ready to define some behaviour for our
component.
</p>
<p>
<a id="createdClass"></a>
<figure>
	<img src="figures/createdClass.png" width="100%" id="createdClass" alt="The class has been created."/>
	<figcaption>The class has been created.</figcaption>
</figure>
</p>
<h3>Defining Basic Methods</h3>
<a id="pharoDefineCode"></a>
<p>
Now we are ready to define some methods for our component. We will define
methods that will be executed on an instance of the <code>WebCounter</code> class. We
call them instance methods since they are executed in reaction to a message
sent to an instance of the component.
</p>
<p>
The first method that we will define is the <code>initialize</code> method, which will be
invoked when an instance of our component is created by Seaside. Seaside follows
normal Pharo convention, and will create an instance of the component for us
by using the message <code>new</code>, which will create the new instance and then send
the message <code>initialize</code> to this new instance.
</p>

<figure><pre><code class="smalltalk">WebCounter &gt;&gt; initialize
   super initialize.
   count := 0</code></pre><figcaption><a id="scr:WebCounterInitialize"></a>WebCounter initialize method.</figcaption></figure>

<p>
Remember that this definition states that the method <code>initialize</code> is an
instance side method since the word <code>class</code> does not appear between
<code>WebCounter</code> and <code>&gt;&gt;</code> in the definition.
</p>
<p>
Once you are done typing the method definition, bring up the context menu for
the code pane and select the menu item <em>accept (s)</em>, as shown in Figure
<a href="#fig:compilingMethod"></a>.
</p>
<p>
At this point Pharo might ask you to enter your full name. This is for the
source code version control system to keep track of the author that wrote this
code.
</p>
<p>
<a id="fig:compilingMethod"></a>
<figure>
	<img src="figures/compilingMethod.png" width="100%" id="fig:compilingMethod" alt="Compiling a method."/>
	<figcaption>Compiling a method.</figcaption>
</figure>
</p>
<p>
The method signature will also appear in the method pane as shown in Figure <a href="#fig:compiledMethod"></a>.
</p>
<p>
<a id="fig:compiledMethod"></a>
<figure>
	<img src="figures/compiledMethod.png" width="100%" id="fig:compiledMethod" alt="The method has been compiled."/>
	<figcaption>The method has been compiled.</figcaption>
</figure>
</p>
<p>
Now let’s review what this means. To create a method, we need to define two
things, the name of the method and the code to be executed. The first line gives
the name of the method we are defining. The next line invokes the superclass
<code>initialize</code> method. The final line sets the value of the count instance
variable to 0.
</p>
<p>
To be ready to define Seaside-specific behaviour, define two more instance methods to change the counter state as in
scripts <a href="#scr:increaseMethod"></a> and <a href="#scr:decreaseMethod"></a>. You can group them in a protocol 'action'.
</p>
<figure><pre><code class="smalltalk">WebCounter &gt;&gt; increase
    count := count + 1</code></pre><figcaption><a id="scr:increaseMethod"></a>Increase method.</figcaption></figure>

<figure><pre><code class="smalltalk">WebCounter &gt;&gt; decrease
    count := count - 1</code></pre><figcaption><a id="scr:decreaseMethod"></a>Decrease method.</figcaption></figure>


<h3>Rendering a Counter</h3>
<a id="pharoRenderCounter"></a>
<p>
Now we can focus on Seaside specific methods. We will define the method
<code>renderContentOn:</code> to display the counter as a heading. When Seaside needs
to display a component in the web browser, it calls the <code>renderContentOn:</code>
method of the component, which allows the component to decide how it should be
rendered.
</p>
<p>
Add a new method category called rendering, and add the method definition in
script <a href="#scr:pharoRenderContentOn"></a>
</p>
<figure><pre><code class="smalltalk">WebCounter&gt;&gt;renderContentOn: html
    html heading: count</code></pre><figcaption><a id="scr:pharoRenderContentOn"></a>Example of <code>renderContentOn:</code> method</figcaption></figure>

<p>
We want to display the value of the variable count by using an HTML heading tag.
In Seaside, rather than having to write the HTML directly, we simply send the
message <code>heading:</code> to the html object that we were given as an argument.
</p>
<p>
As we will see later, when we have completed our application, this method will
give us output as shown in Figure <a href="#fig:simpleCounter"></a>.
</p>
<p>
<a id="simpleCounter"></a>
<figure>
	<img src="figures/simpleCounter.png" width="100%" id="simpleCounter" alt="A simple counter."/>
	<figcaption>A simple counter.</figcaption>
</figure>
</p>
<h4>Registering as a Seaside Application</h4>
<a id="pharoRegisterSeasideApp"></a>
<p>
We will now register our component as an application so that we can access it
directly from the web browser. To register a component as an application, we
need to send the message <code>register:asApplicationAt:</code> to <code>WAAdmin</code>.
</p>
<figure><pre><code>==WAAdmin register: WebCounter asApplicationAt: 'webcounter'==</code></pre><figcaption></figcaption></figure>
<p>
This expression registers the component <code>WebCounter</code> as the application named <code>webcounter</code>. The argument
we add to the <code>register:asApplicationAt:</code> message specifies the root component
and the path that will be used to access the component from the web browser. You
can reach the application under the URL <a href="http://localhost:8080/webcounter">http://localhost:8080/webcounter</a>.
</p>
<p>
<a id="fig:registerComponent"></a>
<figure>
	<img src="figures/registerComponent.png" width="100%" id="fig:registerComponent" alt="Register a component as an application from a workspace."/>
	<figcaption>Register a component as an application from a workspace.</figcaption>
</figure>
</p>
<p>
Now you can launch the application in your web browser by going to
<a href="http://localhost:8080/webcounter/">http://localhost:8080/webcounter/</a> and you will see your first Seaside
component running.
</p>
<p class="todo">Put the link to section 7.2 in pillar</p>
<p>
If you’re already familiar with HTML, you may want to look at the introduction
to halos in Section 7.2 to learn a little more about how to investigate what’s
happening under the covers.
</p>
<h4>Automatically Registering a Component</h4>
<a id="pharoAutomitacRegistery"></a>
<p>
In the future, you may want to automatically register some applications whenever
your package is loaded into an image. To do this, you simply need to add the
registration expression to the <em>class</em> <code>initialize</code> method of the component.
A <em>class</em> <code>initialize</code> method is automatically invoked when the class is
loaded from a file. The script <a href="#scr:classInitialize"></a> the <code>initialize</code> class
method definition.
</p>
<figure><pre><code class="smalltalk">WebCounter class &gt;&gt; initialize
    WAAdmin register: self asApplicationAt: 'webcounter'</code></pre><figcaption><a id="scr:classInitialize"></a>Automitically register your application with an initialize method.</figcaption></figure>

<p>
The word &quot;class&quot; in the <code>WebCounter class&gt;&gt;</code> first line indicates that this
must be added as a class method as described below.
</p>
<p>
Because this code is in the <code>WebCounter</code> class, we can use the term self in
place of the explicit reference to <em>WebCounter</em> that we used in the previous
section. In Smalltalk we avoid hardcoding class names whenever possible.
</p>
<p>
In the future, we will add configuration parameters to this method, so it is
important to be familiar with creating it. Remember that this method is executed
automatically only when the class is loaded into memory from some external
file/source. So if you had not already executed
<code>WAAdmin register: WebCounter asApplicationAt: 'webcounter'</code> Seaside would
still not know about your application. To execute the <code>initialize</code> method
manually, execute <code>WebCounter initialize</code> in a workspace; your application will
be registered and you will be able to access it in your web browser.
</p>
<p class="note">Important Automating the configuration of your Seaside application via class-side <code>initialize</code> methods play an important role in building deployable images because of their role when packages are brought into base images, and is a useful technique to bear in mind for future use.</p>
<p>
The following Figure <a href="#fig:executableComment"></a>  shows a trick Smalltalkers
often use: it adds the expression to be executed as comment in the method. This
way you just have to put your cursor after the first double quote, click once to
select the expression and execute it using the <em>Do it (d)</em> menu item or shortcut.
</p>
<p>
<a id="fig:executableComment"></a>
<figure>
	<img src="figures/executableComment.png" width="100%" id="fig:executableComment" alt="Adding the executable comment."/>
	<figcaption>Adding the executable comment.</figcaption>
</figure>
</p>
<h4>Adding Behavior</h4>
<a id="pharoAddBehavior"></a>
<p>
Now we can add some actions to our component. We start with a very simple
change; we  let the user change the value of the count variable by defining
callbacks attached to links (also known as anchors) displayed when the component
is rendered in a web browser, as shown in Figure <a href="#fig:addLink"></a>. Using callbacks
allows us to define some code that will be executed when a link is clicked.
</p>
<p>
<a id="fig:addLink"></a>
<figure>
	<img src="figures/addLink.png" width="100%" id="fig:addLink" alt="A simple counter with actions."/>
	<figcaption>A simple counter with actions.</figcaption>
</figure>
</p>
<p>
We modify the method <code>WAComponent&gt;&gt;renderContentOn:</code> as in script
<a href="#scr:addCallback"></a>.
</p>
<figure><pre><code class="smalltalk">WebCounter &gt;&gt; renderContentOn: html
    html heading: count.
    html anchor
        callback: [ self increase ];
        with: '++'.
    html space.
    html anchor
        callback: [ self decrease ];
        with: '--'</code></pre><figcaption><a id="scr:addCallback"></a>Add anchors and callbacks to your counter</figcaption></figure>

<p class="note">Don’t forget that <code>WAComponent&gt;&gt;renderContentOn:</code> is on the <em>instance</em> side.</p>
<p>
Each callback is given a Pharo block: an anonymous method (strictly speaking, a
<em>lexical closure</em>) delimited by [ and ]. Here we send the message
<code>callback:</code> (to the result of the anchor message) and pass the block as the
argument. In other words, we ask Seaside to execute our callback block whenever
the user clicks on the anchor.
</p>
<p>
Click on the links to see that the counter get increased or decreased as shown
in Figure <a href="#fig:callbackResult"></a>.
</p>
<p>
<a id="fig:callbackResult"></a>
<figure>
	<img src="figures/callbackResult.png" width="100%" id="fig:callbackResult" alt="A simple counter with a different value."/>
	<figcaption>A simple counter with a different value.</figcaption>
</figure>
</p>
<h4>Adding a Class Comment</h4>
<a id="pharoClassComment"></a>
<p>
A class comment (along with method comments) can help other developers
understand a class. Do not forget to add a nice comment to your class and save it using your 
favorite version control system. 
</p>
<p>
When you’re studying a framework, class comments are a pretty good
place to start reading. Classes that don’t have them require a lot more
developer effort to figure out so get in the habit of adding these comments to
all of your classes.
</p>
<p>
<a id="fig:classComment"></a>
<figure>
	<img src="figures/classComment.png" width="100%" id="fig:classComment" alt="A class comment."/>
	<figcaption>A class comment.</figcaption>
</figure>
</p>
<p>
Now you are set to code in Seaside. 
</p>
<h3>Summary</h3>
<a id="pharoSummary"></a>

<p>
You have now learned how to define a component, register it and modify it. Now you are ready to proceed to Part II to learn all the
details of using Seaside to build powerful web applications.
</p>












  </section>

</article>

<footer>

<div class="footline">
    <div class="github-link">
      <a href="" target="blank"><i class="fa fa-code-fork"></i>Github</a>
    </div>
  </div>
</footer>

<script src="/DynamicWebDevelopmentWithSeaside/_support/html/js/clipboard.min.js"></script>


<link rel="stylesheet" href="/DynamicWebDevelopmentWithSeaside/_support/html/highlightjs/styles/default.css">
<link rel="stylesheet" href="/DynamicWebDevelopmentWithSeaside/_support/html/css/highlight-commands.css">
<link href="/DynamicWebDevelopmentWithSeaside/_support/html/css/featherlight.min.css" rel="stylesheet">
<script src="/DynamicWebDevelopmentWithSeaside/_support/html/js/featherlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="/DynamicWebDevelopmentWithSeaside/_support/html/js/flex.js"></script>
<!-- Prettify annotated paragraphs-->
    <script src="/DynamicWebDevelopmentWithSeaside/_support/html/js/annotated-paragraphs.js"></script>

  </body>
</html>
